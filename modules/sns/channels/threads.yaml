# threads.yaml - Threads 채널 어댑터

channel:
  id: threads
  name: "Threads"
  description: "Threads 플랫폼 자동화 - Meta의 텍스트 기반 SNS"
  enabled: true

  # === 인증 설정 ===
  auth:
    method: "browser"
    profile_name: "default"
    login_url: "https://www.threads.net/login"
    home_url: "https://www.threads.net"

  # === 콘텐츠 설정 ===
  content:
    max_length: 500
    min_length: 20
    tone_ref: "casual"
    language: "ko"

    hashtags:
      enabled: true
      max_count: 5
      position: "end"
      preferred: ["AI", "tech", "coding"]

    media:
      images_allowed: true
      max_images: 10
      videos_allowed: true
      max_video_length_seconds: 300    # 5분
      supported_formats: ["jpg", "png", "gif", "mp4", "heic"]

    thread:
      supported: true
      max_posts: 10
      connector: "→"

  # === 액션 정의 ===
  actions:
    post:
      enabled: true
      script: "core/scripts/browser/threads/post.ts"
      bounds_ref: "sns.posting"
      pre_checks:
        - "shared/validator/similarity"
        - "shared/validator/forbidden"
      require_review: false

    like:
      enabled: true
      script: "core/scripts/browser/threads/like.ts"
      daily_limit: 50
      cooldown_minutes: 1

    follow:
      enabled: true
      script: "core/scripts/browser/threads/follow.ts"
      daily_limit: 20
      cooldown_minutes: 5
      filter:
        min_followers: 10
        exclude_bots: true

    follow_back:
      enabled: true
      script: "core/scripts/browser/threads/follow.ts"
      filter: "not_bot AND followers > 10"
      delay_minutes: 30
      daily_limit: 20

    reply:
      enabled: true
      script: "core/scripts/browser/threads/reply.ts"
      use_llm: true
      daily_limit: 30
      tone_ref: "casual"
      max_length: 500

    repost:
      enabled: true
      script: "core/scripts/browser/threads/repost.ts"
      daily_limit: 10
      quality_threshold: 0.7

    check_notifications:
      enabled: true
      script: "core/scripts/browser/threads/notifications.ts"
      check_interval_minutes: 15

  # === 메트릭 정의 ===
  metrics:
    tracked:
      - id: "followers"
        name: "팔로워"
        query: "SELECT threads_followers FROM daily_stats ORDER BY date DESC LIMIT 1"
      - id: "following"
        name: "팔로잉"
        query: "SELECT threads_following FROM daily_stats ORDER BY date DESC LIMIT 1"
      - id: "posts"
        name: "포스트 수"
        query: "SELECT COUNT(*) FROM posts WHERE platform = 'threads'"
      - id: "engagement_rate"
        name: "참여율"
        query: "SELECT AVG(engagement_rate) FROM post_analytics WHERE platform = 'threads' AND posted_at > date('now', '-7 days')"

    collection:
      schedule: "0 */6 * * *"
      method: "browser_scrape"

  # === 타겟팅 설정 ===
  targeting:
    follow_targets:
      interests: ["AI", "tech", "design", "startup", "coding"]
      min_followers: 50
      max_followers: 50000
      language: "ko"

    engagement_targets:
      topics: ["AI", "tech", "coding", "productivity"]
      exclude_topics: ["politics", "religion"]

  # === 크로스 포스팅 ===
  cross_posting:
    source_channels: ["x"]             # X에서 가져옴
    target_channels: []
    adapt_content: true
    delay_minutes: 30

    # X → Threads 변환 규칙
    adaptation_rules:
      - from_length: 280
        to_length: 500
        action: "expand_if_needed"
      - from_hashtag_style: "#태그"
        to_hashtag_style: "태그"       # Threads는 # 없이도 OK
