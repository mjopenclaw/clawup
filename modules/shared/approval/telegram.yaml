# telegram.yaml - í…”ë ˆê·¸ë¨ ìŠ¹ì¸ ì‹œìŠ¤í…œ
# ì½˜í…ì¸  ê²€í†  ë° ìŠ¹ì¸ì„ í…”ë ˆê·¸ë¨ìœ¼ë¡œ ì²˜ë¦¬

approval:
  id: telegram-review
  name: "í…”ë ˆê·¸ë¨ ê²€í† "
  description: "í…”ë ˆê·¸ë¨ìœ¼ë¡œ ì½˜í…ì¸  ê²€í†  ìš”ì²­ ì „ì†¡ ë° ìŠ¹ì¸ ì²˜ë¦¬"

  # === ì±„ë„ ì„¤ì • ===
  channel: telegram
  target: "${config.telegram.monitor.chat_id}"

  # === ë©”ì‹œì§€ í…œí”Œë¦¿ ===
  message_template: |
    ğŸ“ **í¬ìŠ¤íŒ… ê²€í†  ìš”ì²­**
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    **ì±„ë„**: {target_channel}
    **ìœ í˜•**: {content_type}
    **ì˜ˆì • ì‹œê°„**: {scheduled_time}

    **ì½˜í…ì¸ **:
    ```
    {content}
    ```

    {validation_warnings}

    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    âœ… ìŠ¹ì¸: `/approve {request_id}`
    âœï¸ ìˆ˜ì •: `/edit {request_id} [ìˆ˜ì •ëœ ë‚´ìš©]`
    âŒ ê±°ë¶€: `/reject {request_id} [ì‚¬ìœ ]`
    â° ì˜ˆì•½: `/schedule {request_id} [ì‹œê°„]`

  # === ì‘ë‹µ ì²˜ë¦¬ ===
  responses:
    approve:
      pattern: "/approve {id}"
      action: "continue"
      reply: "âœ… ìŠ¹ì¸ë¨! í¬ìŠ¤íŒ… ì§„í–‰í•©ë‹ˆë‹¤."

    edit:
      pattern: "/edit {id} {new_content}"
      action: "replace_and_continue"
      reply: "âœï¸ ìˆ˜ì •ëœ ë‚´ìš©ìœ¼ë¡œ í¬ìŠ¤íŒ…í•©ë‹ˆë‹¤."

    reject:
      pattern: "/reject {id} {reason}"
      action: "skip"
      reply: "âŒ ê±°ë¶€ë¨: {reason}"
      log_reason: true

    schedule:
      pattern: "/schedule {id} {time}"
      action: "reschedule"
      reply: "â° {time}ì— ë‹¤ì‹œ ê²€í†  ìš”ì²­ ë“œë¦¬ê² ìŠµë‹ˆë‹¤."

  # === íƒ€ì„ì•„ì›ƒ ì„¤ì • ===
  timeout:
    duration_minutes: 60              # 1ì‹œê°„ ëŒ€ê¸°
    action: "skip"                    # skip | auto_approve | retry
    message: "â° íƒ€ì„ì•„ì›ƒ: ê²€í†  ì‹œê°„ì´ ì´ˆê³¼ë˜ì–´ ê±´ë„ˆë›°ì—ˆìŠµë‹ˆë‹¤."

    # ìë™ ìŠ¹ì¸ ì˜µì…˜ (ì„ íƒì )
    auto_approve:
      enabled: false
      conditions:
        - "confidence > 0.8"
        - "no_validation_warnings"
        - "content_type != 'sensitive'"

  # === ê²€í†  ëŒ€ê¸°ì—´ ===
  queue:
    max_pending: 10                   # ìµœëŒ€ ëŒ€ê¸° ê²€í†  ìˆ˜
    priority_order:
      - "scheduled_soon"              # ì˜ˆì • ì‹œê°„ ì„ë°•
      - "high_confidence"             # ë†’ì€ ì‹ ë¢°ë„
      - "fifo"                        # ë¨¼ì € ë“¤ì–´ì˜¨ ìˆœ

  # === ì•Œë¦¼ ì„¤ì • ===
  notifications:
    # ê²€í†  ìš”ì²­ ì‹œ
    on_request:
      enabled: true
      sound: true

    # íƒ€ì„ì•„ì›ƒ ê²½ê³ 
    on_timeout_warning:
      enabled: true
      before_minutes: 10
      message: "âš ï¸ 10ë¶„ í›„ íƒ€ì„ì•„ì›ƒ: {request_id}"

    # ì¼ì¼ ìš”ì•½
    daily_summary:
      enabled: true
      time: "21:00"
      template: |
        ğŸ“Š **ì˜¤ëŠ˜ì˜ ê²€í†  ìš”ì•½**
        - ìŠ¹ì¸: {approved_count}
        - ê±°ë¶€: {rejected_count}
        - íƒ€ì„ì•„ì›ƒ: {timeout_count}
        - ëŒ€ê¸° ì¤‘: {pending_count}

  # === ë¹ ë¥¸ ì‘ë‹µ ë²„íŠ¼ ===
  quick_actions:
    enabled: true
    buttons:
      - label: "âœ… ìŠ¹ì¸"
        action: "approve"
      - label: "âŒ ê±°ë¶€"
        action: "reject"
        reason_required: true
      - label: "ğŸ“ ìˆ˜ì • í•„ìš”"
        action: "request_edit"

  # === ë¡œê¹… ===
  logging:
    log_requests: true
    log_responses: true
    log_path: "data/approval_log.json"
