# summarize.yaml - 요약 변환기
# 긴 콘텐츠를 핵심만 추출하여 요약

transformer:
  id: summarize
  name: "요약기"
  description: "긴 콘텐츠를 핵심 메시지로 압축"

  # === 요약 방법 ===
  method: "llm"                        # llm | extractive | hybrid

  # === 기본 설정 ===
  defaults:
    target_length: 280                 # 기본 타겟 길이
    min_length: 50
    preserve_ratio: 0.3                # 원본의 30% 수준으로

  # === LLM 프롬프트 ===
  prompt: |
    다음 콘텐츠를 {target_length}자 이내로 요약해줘.

    원본:
    ---
    {content}
    ---

    요약 규칙:
    1. 핵심 메시지만 남기기
    2. 첫 문장(훅)의 임팩트 유지
    3. CTA가 있다면 보존
    4. 불필요한 수식어, 부연 설명 제거
    5. 원본의 톤 유지

    출력 형식: 요약된 텍스트만 (설명 없이)

  # === 보존 우선순위 ===
  preserve_priority:
    - level: 1
      elements: ["핵심 주장", "핵심 데이터/숫자"]
    - level: 2
      elements: ["CTA", "훅"]
    - level: 3
      elements: ["예시 (1개)"]
    - level: 4
      elements: ["부연 설명"]    # 먼저 제거

  # === 제거 우선순위 ===
  remove_first:
    - "반복되는 표현"
    - "부연 설명"
    - "부가적 예시"
    - "접속사로 시작하는 문장"
    - "~라고 할 수 있다 같은 완화 표현"

  # === 요약 패턴 ===
  patterns:
    # 뉴스/정보 요약
    - type: "news"
      template: "[핵심 사실] + [의미/영향]"
      example: "OpenAI가 GPT-5 발표. 기존 대비 10배 빠른 추론 속도."

    # 의견/인사이트 요약
    - type: "opinion"
      template: "[주장] + [근거 1개]"
      example: "AI 규제는 시기상조. 아직 피해 사례보다 혜택이 크다."

    # 가이드/방법 요약
    - type: "how_to"
      template: "[핵심 방법] + [기대 효과]"
      example: "매일 아침 10분 글쓰기로 한 달에 30개 콘텐츠 생성 가능."

  # === 품질 체크 ===
  quality_checks:
    - name: "의미 보존"
      description: "원본 핵심 메시지가 유지되었는지"
      method: "semantic_similarity"
      threshold: 0.7

    - name: "길이 준수"
      description: "타겟 길이 이내인지"
      method: "character_count"

    - name: "문법 오류"
      description: "문법적으로 완전한 문장인지"
      method: "grammar_check"

  # === 실패 처리 ===
  on_failure:
    # LLM 실패 시
    fallback_method: "extractive"
    # 추출적 요약: 중요 문장만 선택
    extractive_params:
      select_sentences: 2
      prefer_first_sentence: true

  # === 로깅 ===
  logging:
    log_summaries: true
    log_path: "data/summary_log.json"
    include_original: true
