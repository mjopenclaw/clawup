# adapt-length.yaml - ê¸¸ì´ ì–´ëŒ‘í„°
# ì½˜í…ì¸  ê¸¸ì´ë¥¼ íƒ€ê²Ÿ í”Œë«í¼ì— ë§ê²Œ ì¡°ì •

transformer:
  id: adapt-length
  name: "ê¸¸ì´ ì–´ëŒ‘í„°"
  description: "ì½˜í…ì¸  ê¸¸ì´ë¥¼ íƒ€ê²Ÿ í”Œë«í¼ ì œí•œì— ë§ê²Œ ì¡°ì •"

  # === ê¸¸ì´ ê·œì¹™ ===
  rules:
    # ì§§ê²Œ ì¤„ì—¬ì•¼ í•  ë•Œ
    - condition: "content_length > target_length"
      action: "summarize"
      params:
        preserve:
          - "í•µì‹¬ ë©”ì‹œì§€"
          - "CTA (Call to Action)"
          - "í›… (ì²« ë¬¸ì¥)"
        remove_first:
          - "ë¶€ì—° ì„¤ëª…"
          - "ì˜ˆì‹œ"
          - "ë°˜ë³µë˜ëŠ” í‘œí˜„"

    # ëŠ˜ë ¤ì•¼ í•  ë•Œ
    - condition: "content_length < min_length"
      action: "expand"
      params:
        add:
          - "êµ¬ì²´ì  ì˜ˆì‹œ"
          - "ê´€ë ¨ ë§¥ë½"
          - "CTA"

    # ìŠ¤ë ˆë“œë¡œ ë¶„í• 
    - condition: "content_length > thread_threshold"
      action: "split_to_thread"
      params:
        max_per_post: 280
        connector: "ğŸ§µ"
        numbering: true                # 1/, 2/, 3/ í˜•ì‹

  # === í”Œë«í¼ë³„ ì„¤ì • ===
  platforms:
    x:
      max_length: 280
      min_length: 50
      thread_threshold: 280
      thread_max_posts: 10

    threads:
      max_length: 500
      min_length: 50
      thread_threshold: 500

    blog:
      min_length: 500
      max_length: 5000

  # === ìš”ì•½ ì „ëµ ===
  summarize_strategy:
    method: "llm"                      # llm | extractive | abstractive
    prompt: |
      ë‹¤ìŒ ì½˜í…ì¸ ë¥¼ {target_length}ì ì´ë‚´ë¡œ ìš”ì•½í•´ì¤˜.

      ì›ë³¸:
      {content}

      ê·œì¹™:
      - í•µì‹¬ ë©”ì‹œì§€ ìœ ì§€
      - í›…(ì²« ë¬¸ì¥) ë³´ì¡´
      - CTA ìœ ì§€
      - ë¶ˆí•„ìš”í•œ ë¶€ì—° ì„¤ëª… ì œê±°

    fallback:
      # LLM ì‹¤íŒ¨ ì‹œ
      method: "truncate"
      suffix: "..."

  # === í™•ì¥ ì „ëµ ===
  expand_strategy:
    method: "llm"
    prompt: |
      ë‹¤ìŒ ì½˜í…ì¸ ë¥¼ {target_length}ì ì´ìƒìœ¼ë¡œ í™•ì¥í•´ì¤˜.

      ì›ë³¸:
      {content}

      ê·œì¹™:
      - ì›ë³¸ ë©”ì‹œì§€ ìœ ì§€
      - êµ¬ì²´ì  ì˜ˆì‹œ ì¶”ê°€
      - ê´€ë ¨ ë§¥ë½ ë³´ì¶©
      - ìì—°ìŠ¤ëŸ¬ìš´ íë¦„

  # === ìŠ¤ë ˆë“œ ë¶„í•  ì „ëµ ===
  thread_strategy:
    split_by: "sentence"               # sentence | paragraph | manual
    ensure_hook_first: true            # ì²« íŠ¸ìœ—ì— í›… í¬í•¨
    cta_position: "last"               # ë§ˆì§€ë§‰ íŠ¸ìœ—ì— CTA

    format:
      numbering: "1/"                  # 1/, 2/ or (1), (2) or ğŸ§µ1
      connector_emoji: "ğŸ§µ"
      end_indicator: "ë"

  # === ìœ íš¨ì„± ê²€ì‚¬ ===
  validation:
    # ë³€í™˜ í›„ ì²´í¬
    post_transform:
      - check: "length_within_limit"
      - check: "preserves_meaning"
      - check: "no_truncated_words"

  # === ë¡œê¹… ===
  logging:
    log_transformations: true
    log_path: "data/transform_log.json"
